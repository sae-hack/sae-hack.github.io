(this["webpackJsonprealtime-transcribe-react"]=this["webpackJsonprealtime-transcribe-react"]||[]).push([[0],{448:function(e,n,t){},450:function(e,n,t){},456:function(e,n){},458:function(e,n){},468:function(e,n){},470:function(e,n){},495:function(e,n){},497:function(e,n){},498:function(e,n){},503:function(e,n){},505:function(e,n){},511:function(e,n){},513:function(e,n){},532:function(e,n){},544:function(e,n){},547:function(e,n){},623:function(e,n,t){var r={"./amplify-amazon-button_5.entry.js":[864,16],"./amplify-auth-container.entry.js":[865,17],"./amplify-auth-fields_9.entry.js":[866,18],"./amplify-authenticator.entry.js":[867,5],"./amplify-button_3.entry.js":[868,19],"./amplify-chatbot.entry.js":[869,4],"./amplify-checkbox.entry.js":[870,20],"./amplify-confirm-sign-in_7.entry.js":[871,6],"./amplify-container.entry.js":[872,21],"./amplify-federated-buttons_2.entry.js":[873,22],"./amplify-federated-sign-in.entry.js":[874,23],"./amplify-form-field_4.entry.js":[875,24],"./amplify-greetings.entry.js":[876,25],"./amplify-icon-button.entry.js":[877,26],"./amplify-icon.entry.js":[878,7],"./amplify-link.entry.js":[879,27],"./amplify-nav_2.entry.js":[880,28],"./amplify-photo-picker.entry.js":[881,29],"./amplify-picker.entry.js":[882,30],"./amplify-radio-button_3.entry.js":[883,8],"./amplify-s3-album.entry.js":[884,9],"./amplify-s3-image-picker.entry.js":[885,10],"./amplify-s3-image.entry.js":[886,11],"./amplify-s3-text-picker.entry.js":[887,12],"./amplify-s3-text.entry.js":[888,13],"./amplify-select-mfa-type.entry.js":[889,31],"./amplify-sign-in-button.entry.js":[890,14],"./amplify-tooltip.entry.js":[891,32]};function a(e){if(!t.o(r,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=r[e],a=n[0];return t.e(n[1]).then((function(){return t(a)}))}a.keys=function(){return Object.keys(r)},a.id=623,e.exports=a},859:function(e,n,t){"use strict";t.r(n);var r,a=t(0),i=t.n(a),c=t(48),o=t.n(c),s=(t(448),t(108)),u=t(41),l=t(51),d=t(31),j=(t(449),t(450),t(926)),b=t(253),p=t(921),f=t(922),O=t(431),h=t(38),m=t(39),g=t(59),x=t(58),v=t(143),k=t(198),y=t(420),S=t(146);!function(e){e[e.SetUser=0]="SetUser",e[e.OverrideSpeaker=1]="OverrideSpeaker",e[e.StartSessionRequest=2]="StartSessionRequest",e[e.StartSessionSuccess=3]="StartSessionSuccess",e[e.StartSessionFailure=4]="StartSessionFailure",e[e.StopSession=5]="StopSession"}(r||(r={}));var w,C,I,T,N,M,A,E,D=t(184),F=t(139),_=t(416),U=function(e,n){return function(t){var a;t({type:r.StartSessionRequest}),(a="/start-session",F.a.currentSession().then((function(e){var n=e.getIdToken().getJwtToken();return _.a.get("SAMAPI",a,{headers:{Authorization:"Bearer "+n}})}))).then((function(a){var i=a.credentials;window.handleEventStreamMessage=n,window.region=e,window.access_id=i.AccessKeyId,window.secret_key=i.SecretAccessKey,window.session_token=i.SessionToken,window.startTranscribe(),t({type:r.StartSessionSuccess})})).catch((function(e){t({type:r.StartSessionFailure,error:e})}))}},P=Object(k.c)(Object(k.b)({users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case r.SetUser:return{user:n.user};default:return e}},speakers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case r.OverrideSpeaker:return Object(u.a)(Object(u.a)({},e),{},Object(D.a)({},n.speakerId,n.speakerName));default:return e}},session:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case r.StartSessionRequest:return{fetchingCredential:!0};case r.StartSessionSuccess:return{recording:!0};case r.StartSessionFailure:return{error:n.error};case r.StopSession:return{recording:!1};default:return e}}}),Object(k.a)(y.a)),R=function(){return Object(S.b)()},z=S.c,B=function(){return z((function(e){return e.users.user}))},q=function(){return z((function(e){return e.speakers}))},L=t(5),Q=m.a.div(w||(w=Object(h.a)(["\n  display: flex;\n  width: auto;\n  align-items: center;\n\n  .status-icon {\n    padding-right: 5px;\n  }\n"]))),J=function(e){var n=e.onEventStreamMessage,t=e.saveToQuip,i=B(),c=z((function(e){return e.session})),o=c.fetchingCredential,s=c.recording,u=R(),l=Object(a.useCallback)((function(){i&&u(U("us-west-2",n))}),[u,i,n]),d=Object(a.useCallback)((function(){i&&u((function(e){window.closeSocket(),e({type:r.StopSession})}))}),[u,i]),b=Object(a.useCallback)((function(){var e=localStorage.getItem("quip-token")||"",n=prompt("Quip Token (get one from https://quip-amazon.com/dev/token):",e);if(n){localStorage.setItem("quip-token",n);var r=prompt("Quip document URL:");r&&t(r,n)}}),[t]);return Object(L.jsxs)(Q,{children:[Object(L.jsxs)("div",{className:"status-icon",children:[o&&Object(L.jsx)(v.ClipLoader,{color:"white",size:20}),s&&Object(L.jsx)(v.ScaleLoader,{color:"white",height:20})]}),Object(L.jsx)(j.b,{disabled:!i,onClick:b,children:"Save to Quip"}),Object(L.jsx)(j.b,{disabled:!i,onClick:l,style:{display:s?"none":"unset"},children:Object(L.jsx)(x.a,{icon:g.d})}),Object(L.jsx)(j.b,{disabled:!i,onClick:d,style:{display:s?"unset":"none"},children:Object(L.jsx)(x.a,{icon:g.e})})]})},K=m.a.div(C||(C=Object(h.a)(["\n  height: 100%;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n\n  & > span {\n    margin: 0 1rem;\n  }\n"]))),W=function(){var e,n=B();return n?Object(L.jsxs)(K,{children:[Object(L.jsx)("span",{children:null===n||void 0===n||null===(e=n.attributes)||void 0===e?void 0:e.email}),Object(L.jsx)(j.c,{})]}):null},G=m.a.div(I||(I=Object(h.a)(["\n  display: flex;\n  position: fixed;\n  width: 100%;\n  bottom: 0;\n  background-color: orange;\n  justify-content: space-between;\n  color: white;\n"]))),H=function(e){return Object(L.jsxs)(G,{children:[Object(L.jsx)(W,{}),Object(L.jsx)(J,Object(u.a)({},e))]})},V=t(928),X=t(426),Y=t.n(X),Z=t(924),$=t(923),ee=t(920),ne=t(19),te=t(427),re=t(434),ae=(t(722),t(252)),ie=function(e){var n=e.value,t=e.onChange,r=e.onBlur,i=Object(a.useMemo)((function(){var e=Object(re.a)();return[[e],e.InlineToolbar]}),[]),c=Object(d.a)(i,2),o=c[0],s=c[1],u=Object(a.useState)((function(){return ne.EditorState.createWithContent(Object(ne.convertFromRaw)(Object(ae.b)(n)))})),l=Object(d.a)(u,2),j=l[0],b=l[1],p=Object(a.useCallback)((function(e){b(e);var n=Object(ae.a)(Object(ne.convertToRaw)(e.getCurrentContent()),{styleItems:{UNDERLINE:{open:function(){return"<u>"},close:function(){return"</u>"}}}});t(n)}),[t]);return Object(L.jsxs)("div",{children:[Object(L.jsx)(te.a,{editorState:j,onChange:p,onBlur:r,plugins:o}),Object(L.jsx)(s,{})]})},ce=t(428),oe=t.n(ce),se=m.a.div(T||(T=Object(h.a)(["\n  padding-bottom: 10px;\n"]))),ue=m.a.div(N||(N=Object(h.a)(["\n  min-height: 60px;\n  cursor: pointer;\n\n  svg {\n    position: absolute;\n    bottom: 5px;\n    right: 5px;\n  }\n"]))),le=function(e){var n=e.value,t=e.onChange,r=Object(a.useState)(!1),i=Object(d.a)(r,2),c=i[0],o=i[1];return c?Object(L.jsx)(se,{children:Object(L.jsx)(ie,{value:n,onChange:t,onBlur:function(){return o(!1)}})}):Object(L.jsxs)(ue,{onClick:function(){return o(!0)},children:[Object(L.jsx)("span",{children:Object(L.jsx)(oe.a,{children:n})}),Object(L.jsx)($.a,{placement:"top",overlay:Object(L.jsx)(ee.a,{id:"edit-tooltip",children:"Click the text to edit, highlight text to style it."}),children:Object(L.jsx)(x.a,{icon:g.b})})]})},de=m.a.div(M||(M=Object(h.a)(["\n  display: flex;\n  border: solid 1px;\n  border-radius: 5px;\n  margin: 1rem;\n\n  .meta {\n    flex-shrink: 0;\n    width: 120px;\n    position: relative;\n    text-align: center;\n    min-height: 50px;\n\n    .speaking {\n      margin-top: 5px;\n    }\n\n    .speaker {\n      width: 120px;\n      height: 80px;\n\n      .speaker-icon {\n        font-size: 30px;\n      }\n\n      .speaker-label {\n        font-weight: bold;\n        cursor: pointer;\n        font-size: 1rem;\n\n        .btn {\n          /* erase the styles brought by react-bootstrap */\n          background-color: unset !important;\n          border: unset !important;\n          color: black;\n        }\n      }\n    }\n  }\n\n  .content {\n    padding: 5px;\n    flex-grow: 1;\n    position: relative;\n\n    .form-control {\n      background-color: transparent !important;\n    }\n\n    .timestamp {\n      position: absolute;\n      font-size: 0.6rem;\n      bottom: 5px;\n      left: 10px;\n    }\n\n    .merge-up-button {\n      position: absolute;\n      bottom: 1px;\n      right: 52px;\n      cursor: pointer;\n    }\n\n    .delete-button {\n      position: absolute;\n      bottom: 1px;\n      right: 32px;\n      cursor: pointer;\n    }\n  }\n"]))),je=function(e){var n=e.dialog,t=e.partial,r=e.color,i=void 0===r?"#fff":r,c=e.speakerOptions,o=e.onSetSpeaker,s=e.updateDialog,u=e.onMergeUpDialog,l=e.onDeleteDialog,j=Object(a.useState)(!1),b=Object(d.a)(j,2),p=b[0],f=b[1],O=q(),h=Y()(i),m=n&&(O[n.speaker]||String(n.speaker));return Object(L.jsxs)(de,{style:{borderColor:i},children:[Object(L.jsxs)("div",{className:"meta",style:{backgroundColor:i},children:[n&&Object(L.jsx)(L.Fragment,{children:Object(L.jsxs)("div",{className:"speaker",children:[Object(L.jsx)("div",{className:"speaker-icon",children:Object(L.jsx)(x.a,{icon:g.g})}),Object(L.jsx)("div",{className:"speaker-label",onClick:function(){return f(!0)},children:Object(L.jsxs)(Z.a,{children:[Object(L.jsx)($.a,{placement:"top",overlay:Object(L.jsx)(ee.a,{id:"edit-dialog-speaker-tooltip",children:"Select the speaker for this bubble"}),children:Object(L.jsx)(Z.a.Toggle,{children:m})}),Object(L.jsx)(Z.a.Menu,{show:p,children:c.map((function(e){return Object(L.jsx)(Z.a.Item,{href:"#",onClick:function(){return o(n,e)},children:e},e)}))})]})})]})}),t&&Object(L.jsx)("div",{className:"speaking",children:Object(L.jsx)(v.BeatLoader,{})})]}),Object(L.jsxs)("div",{className:"content",style:{backgroundColor:h.lighten(.2).hex()},children:[n&&Object(L.jsx)(le,{value:n.words,onChange:function(e){s&&n&&s(n.dialogId,e)}}),t&&Object(L.jsx)("span",{children:t}),n&&Object(L.jsxs)("div",{className:"timestamp",children:[Object(L.jsx)(x.a,{icon:g.a})," ",n.startTime.toFixed(2),"s"]}),n&&u&&Object(L.jsx)($.a,{placement:"top",overlay:Object(L.jsx)(ee.a,{id:"merge-up-tooltip",children:"Merge this into the previous bubble"}),children:Object(L.jsx)("div",{className:"merge-up-button",onClick:function(){return u(n.dialogId)},children:Object(L.jsx)(x.a,{icon:g.c})})}),n&&l&&Object(L.jsx)("div",{className:"delete-button",onClick:function(){return l(n.dialogId)},children:Object(L.jsx)(x.a,{icon:g.f})})]})]})},be=i.a.memo(je),pe=t(251),fe=t.n(pe),Oe=t(927),he=t(925),me=t(430),ge=m.a.span(A||(A=Object(h.a)(["\n  cursor: pointer;\n"]))),xe=function(e){var n=e.children,t=e.onChange,r=Object(a.useState)(n),i=Object(d.a)(r,2),c=i[0],o=i[1],s=Object(a.useState)(!1),u=Object(d.a)(s,2),l=u[0],j=u[1];return Object(a.useEffect)((function(){o(n)}),[n]),l?Object(L.jsxs)("div",{children:[Object(L.jsx)(he.a.Control,{value:c,onChange:function(e){return o(e.target.value)}}),Object(L.jsx)(me.a,{onClick:function(){o(n),j(!1)},children:"Cancel"})," ",Object(L.jsx)(me.a,{onClick:function(){t(c),j(!1)},children:"Save"})]}):Object(L.jsxs)(ge,{onClick:function(){return j(!0)},children:[Object(L.jsx)(x.a,{icon:g.b})," ",c]})},ve=m.a.div(E||(E=Object(h.a)(["\n  position: fixed;\n  right: 0;\n  padding: 5px;\n  width: 25%;\n"]))),ke=function(e){var n=e.speakerNames,t=e.onNameChange,r=e.unallocatedSpeakerNames,i=e.addNewSpeaker,c=Object(a.useState)(""),o=Object(d.a)(c,2),s=o[0],u=o[1];return Object(L.jsxs)(ve,{children:[Object(L.jsx)("h3",{children:"Speakers"}),Object(L.jsxs)(Oe.a,{children:[n.map((function(e){return Object(L.jsx)(Oe.a.Item,{children:Object(L.jsx)(xe,{onChange:function(n){return t(e,n)},children:e})},e)})),r.map((function(e){return Object(L.jsx)(Oe.a.Item,{style:{background:"#ccc"},children:Object(L.jsx)(xe,{onChange:function(n){return t(e,n)},children:e})},e)}))]}),Object(L.jsx)(he.a.Control,{value:s,onChange:function(e){return u(e.target.value)}}),Object(L.jsx)(me.a,{disabled:!s,onClick:function(){s&&i(s),u("")},children:"Add Speaker"})]})},ye=[],Se=fe()({count:6,lightMin:80}).map((function(e){return e.hex()})),we=function(){var e=R();Object(a.useEffect)((function(){return Object(b.b)((function(n,t){n===b.a.SignedIn?e({type:r.SetUser,user:t}):e({type:r.SetUser,user:void 0})}))}),[e]);var n=B(),t=function(){var e=Object(a.useState)([]),n=Object(d.a)(e,2),t=n[0],r=n[1],i=Object(a.useState)(""),c=Object(d.a)(i,2),o=c[0],j=c[1],b=Object(a.useState)(),p=Object(d.a)(b,2),f=p[0],O=(p[1],Object(a.useCallback)((function(e){var n=e.Transcript.Results;if(n.length>0&&n[0].Alternatives.length>0){var t=n[0].Alternatives[0].Transcript;t=decodeURIComponent(escape(t)),n[0].IsPartial?j(t):(j(""),r((function(e){var t,r=[],a=!1,i=Object(s.a)(n[0].Alternatives[0].Items);try{for(i.s();!(t=i.n()).done;){var c=t.value,o=c.Speaker,d=c.Content,j=c.Type,b=c.StartTime,p=c.EndTime;if("speaker-change"!==j){var f=r.length>0?r[r.length-1]:void 0;f&&void 0!==f.speaker&&void 0!==o&&f.speaker!==o&&(a=!0),!f||a?r.push({dialogId:Object(V.a)(),speaker:o,words:d,startTime:b,endTime:p}):(r.pop(),r.push(Object(u.a)(Object(u.a)({},f),{},{words:f.words+("pronunciation"===j?" ":"")+d,endTime:p}))),a=!1}else a=!0}}catch(O){i.e(O)}finally{i.f()}return[].concat(Object(l.a)(e),r)})))}}),[]));return{transcription:t,setTranscription:r,handleEventStreamMessage:O,partial:o,error:f}}(),i=t.transcription,c=t.setTranscription,o=t.partial,h=t.handleEventStreamMessage,m=Object(a.useState)([]),g=Object(d.a)(m,2),x=g[0],v=g[1],k=q(),y=Object(l.a)(new Set(i.map((function(e){var n=e.speaker;return k[n]||String(n)})))).sort();Object(a.useEffect)((function(){v((function(e){return e.filter((function(e){return y.includes(e)})).length>0?e.filter((function(e){return!y.includes(e)})):e}))}),[y]);var S=Object(a.useMemo)((function(){return y.length>6?fe()({count:y.length}).map((function(e){return e.hex()})):Se}),[y.length]),w=Object(a.useCallback)((function(n,t){var a=null;for(var i in k)if(k[i]===n){a=i;break}null===a&&y.includes(n)?a=parseInt(n):console.error("Cannot find speaker with existing name ",n),e({type:r.OverrideSpeaker,speakerId:a,speakerName:t})}),[k,y,e]),C=Object(a.useCallback)((function(e){y.includes(e)||x.includes(e)?alert("".concat(e," already exists")):v((function(n){return[].concat(Object(l.a)(n),[e])}))}),[x,y]),I=Object(a.useMemo)((function(){return[].concat(Object(l.a)(y),Object(l.a)(x))}),[y,x]),T=Object(a.useCallback)((function(n,t){var a;if(x.includes(t))a=function(){if(0===ye.length)return ye.push(1e4),1e4;var e=ye[ye.length-1]+1;return ye.push(e),e}();else{var i=null;for(var o in k)if(k[o]===t){i=o;break}null===i&&y.includes(t)?i=parseInt(t):console.error("Cannot find speaker with existing name ",t),a=i}e({type:r.OverrideSpeaker,speakerId:a,speakerName:t}),c((function(e){var t=e.indexOf(n);return[].concat(Object(l.a)(e.slice(0,t)),[Object(u.a)(Object(u.a)({},n),{},{speaker:a})],Object(l.a)(e.slice(t+1)))}))}),[y,c,k,x,e]),N=Object(a.useCallback)((function(e,n){var t,r,a=function(e,n){var t,r=["# Transcribe"],a=Object(s.a)(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;r.push("(".concat(i.startTime.toFixed(2),"-").concat(i.endTime.toFixed(2),") **").concat(n[i.speaker]||i.speaker,"** ").concat(i.words))}}catch(c){a.e(c)}finally{a.f()}return r.join("\n\n")}(i,k);(t="/putDocument",r={content:a,documentUrl:e,quipToken:n},F.a.currentSession().then((function(e){var n=e.getIdToken().getJwtToken();return _.a.put("SAMAPI",t,{body:r,headers:{Authorization:"Bearer "+n}})}))).then((function(){window.open(e)})).catch((function(e){return alert(e)}))}),[i,k]),M=Object(a.useCallback)((function(e,n){c((function(t){var r,a=[],i=Object(s.a)(t);try{for(i.s();!(r=i.n()).done;){var c=r.value;if(c.dialogId===e){var o=Object(u.a)(Object(u.a)({},c),{},{words:n});a.push(o)}else a.push(c)}}catch(l){i.e(l)}finally{i.f()}return a}))}),[c]),A=Object(a.useCallback)((function(e){c((function(n){var t=n.map((function(e){return e.dialogId})).indexOf(e),r=n[t-1],a=n[t],i=Object(u.a)(Object(u.a)({},r),{},{endTime:a.endTime,words:r.words+" "+a.words});return[].concat(Object(l.a)(n.slice(0,t-1)),[i],Object(l.a)(n.slice(t+1)))}))}),[c]),E=Object(a.useCallback)((function(e){c((function(n){var t=n.map((function(e){return e.dialogId})).indexOf(e);return[].concat(Object(l.a)(n.slice(0,t)),Object(l.a)(n.slice(t+1)))}))}),[c]);return Object(L.jsx)(j.a,{children:n&&Object(L.jsxs)("div",{children:[Object(L.jsx)("div",{children:Object(L.jsx)(p.a,{fluid:!0,style:{marginBottom:"5rem"},children:Object(L.jsxs)(f.a,{children:[Object(L.jsxs)(O.a,{xs:9,children:[Object(L.jsx)("h3",{children:"Conversation"}),i.map((function(e,n){return Object(L.jsx)(be,{dialog:e,color:S[y.indexOf(k[e.speaker]||String(e.speaker))],speakerOptions:I,onSetSpeaker:T,updateDialog:M,onMergeUpDialog:n>0?A:void 0,onDeleteDialog:E},n)})),o&&Object(L.jsx)(be,{partial:o,speakerOptions:I,onSetSpeaker:T})]}),Object(L.jsx)(O.a,{children:Object(L.jsx)(ke,{speakerNames:y,onNameChange:w,unallocatedSpeakerNames:x,addNewSpeaker:C})})]})})}),Object(L.jsx)(H,{onEventStreamMessage:h,saveToQuip:N})]})})},Ce=function(e){e&&e instanceof Function&&t.e(35).then(t.bind(null,941)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,i=n.getLCP,c=n.getTTFB;t(e),r(e),a(e),i(e),c(e)}))};t(245).default.configure({Auth:{identityPoolId:"us-west-2:b712e33e-583d-42df-b9fa-14325852efbf",region:"us-west-2",userPoolId:"us-west-2_gdDt1nKsQ",userPoolWebClientId:"6ihc4536tkdk627cmkomahfmkl"},API:{endpoints:[{name:"SAMAPI",endpoint:"https://3apx34jtve.execute-api.us-west-2.amazonaws.com/Prod"}]}}),o.a.render(Object(L.jsx)(i.a.StrictMode,{children:Object(L.jsx)(S.a,{store:P,children:Object(L.jsx)(we,{})})}),document.getElementById("root")),Ce()}},[[859,2,3]]]);
//# sourceMappingURL=main.e5b25755.chunk.js.map