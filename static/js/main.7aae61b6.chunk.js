(this["webpackJsonprealtime-transcribe-react"]=this["webpackJsonprealtime-transcribe-react"]||[]).push([[0],{434:function(e,n,t){},436:function(e,n,t){},442:function(e,n){},444:function(e,n){},454:function(e,n){},456:function(e,n){},481:function(e,n){},483:function(e,n){},484:function(e,n){},489:function(e,n){},491:function(e,n){},497:function(e,n){},499:function(e,n){},518:function(e,n){},530:function(e,n){},533:function(e,n){},607:function(e,n,t){var r={"./amplify-amazon-button_5.entry.js":[851,16],"./amplify-auth-container.entry.js":[852,17],"./amplify-auth-fields_9.entry.js":[853,18],"./amplify-authenticator.entry.js":[854,5],"./amplify-button_3.entry.js":[855,19],"./amplify-chatbot.entry.js":[856,4],"./amplify-checkbox.entry.js":[857,20],"./amplify-confirm-sign-in_7.entry.js":[858,6],"./amplify-container.entry.js":[859,21],"./amplify-federated-buttons_2.entry.js":[860,22],"./amplify-federated-sign-in.entry.js":[861,23],"./amplify-form-field_4.entry.js":[862,24],"./amplify-greetings.entry.js":[863,25],"./amplify-icon-button.entry.js":[864,26],"./amplify-icon.entry.js":[865,7],"./amplify-link.entry.js":[866,27],"./amplify-nav_2.entry.js":[867,28],"./amplify-photo-picker.entry.js":[868,29],"./amplify-picker.entry.js":[869,30],"./amplify-radio-button_3.entry.js":[870,8],"./amplify-s3-album.entry.js":[871,9],"./amplify-s3-image-picker.entry.js":[872,10],"./amplify-s3-image.entry.js":[873,11],"./amplify-s3-text-picker.entry.js":[874,12],"./amplify-s3-text.entry.js":[875,13],"./amplify-select-mfa-type.entry.js":[876,31],"./amplify-sign-in-button.entry.js":[877,14],"./amplify-tooltip.entry.js":[878,32]};function a(e){if(!t.o(r,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=r[e],a=n[0];return t.e(n[1]).then((function(){return t(a)}))}a.keys=function(){return Object.keys(r)},a.id=607,e.exports=a},846:function(e,n,t){"use strict";t.r(n);var r,a,c,i,o,s,u,l,j=t(0),b=t.n(j),d=t(129),f=t.n(d),p=(t(434),t(102)),O=t(136),h=t(45),m=t(72),x=t(22),v=(t(435),t(436),t(910)),g=t(239),k=t(906),y=t(907),C=t(417),S=t(37),w=t(38),T=t(179),I=Object(j.createContext)(void 0),N=Object(j.createContext)({speakers:{},setSpeakers:function(e){return null}}),A=t(912),P=function(){return Object(j.useContext)(I)},_=t(133),E=t(401),M=t(5),F=w.a.div(r||(r=Object(S.a)(["\n  display: flex;\n  width: auto;\n  align-items: center;\n"]))),B=function(e){var n=e.setCredential,t=e.setStop,r=e.saveToQuip,a=P(),c=Object(j.useState)(!1),i=Object(x.a)(c,2),o=i[0],s=i[1],u=Object(j.useCallback)((function(){var e;a&&(s(!0),t(!1),(e="/start-session",_.a.currentSession().then((function(n){var t=n.getIdToken().getJwtToken();return E.a.get("SAMAPI",e,{headers:{Authorization:"Bearer "+t}})}))).then((function(e){n(e.credentials),s(!1)})).catch((function(){return s(!1)})))}),[a,n]),l=Object(j.useCallback)((function(){a&&t(!0)}),[a,t]),b=Object(j.useCallback)((function(){var e=prompt("Quip document URL:");e&&r(e)}),[r]);return Object(M.jsxs)(F,{children:[o&&Object(M.jsx)(T.ClipLoader,{color:"white",size:20}),Object(M.jsx)(v.b,{disabled:!a,onClick:b,children:"Save to Quip"}),Object(M.jsx)(v.b,{disabled:!a,onClick:u,children:"Start"}),Object(M.jsx)(v.b,{disabled:!a,onClick:l,children:"Stop"})]})},z=w.a.div(a||(a=Object(S.a)(["\n  height: 100%;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n\n  & > span {\n    margin: 0 1rem;\n  }\n"]))),D=function(){var e,n=P();return n?Object(M.jsxs)(z,{children:[Object(M.jsx)("span",{children:null===n||void 0===n||null===(e=n.attributes)||void 0===e?void 0:e.email}),Object(M.jsx)(v.c,{})]}):null},L=w.a.div(c||(c=Object(S.a)(["\n  display: flex;\n  position: fixed;\n  width: 100%;\n  bottom: 0;\n  background-color: orange;\n  justify-content: space-between;\n  color: white;\n"]))),R=function(e){return Object(M.jsxs)(L,{children:[Object(M.jsx)(D,{}),Object(M.jsx)(B,Object(h.a)({},e))]})},U=t(92),Q=t(91),J=t(410),K=t.n(J),W=t(908),q=t(18),G=t(411),H=t(420),V=(t(708),t(238)),X=function(e){var n=e.value,t=e.onChange,r=e.onBlur,a=Object(j.useMemo)((function(){var e=Object(H.a)();return[[e],e.InlineToolbar]}),[]),c=Object(x.a)(a,2),i=c[0],o=c[1],s=Object(j.useState)((function(){return q.EditorState.createWithContent(Object(q.convertFromRaw)(Object(V.b)(n)))})),u=Object(x.a)(s,2),l=u[0],b=u[1],d=Object(j.useCallback)((function(e){b(e);var n=Object(V.a)(Object(q.convertToRaw)(e.getCurrentContent()),{styleItems:{UNDERLINE:{open:function(){return"<u>"},close:function(){return"</u>"}}}});t(n)}),[t]);return Object(M.jsxs)("div",{children:[Object(M.jsx)(G.a,{editorState:l,onChange:d,onBlur:r,plugins:i}),Object(M.jsx)(o,{})]})},Y=t(412),Z=t.n(Y),$=w.a.div(i||(i=Object(S.a)(["\n  padding-bottom: 10px;\n"]))),ee=w.a.div(o||(o=Object(S.a)(["\n  min-height: 60px;\n  cursor: pointer;\n\n  svg {\n    position: absolute;\n    bottom: 5px;\n    right: 5px;\n  }\n"]))),ne=function(e){var n=e.value,t=e.onChange,r=Object(j.useState)(!1),a=Object(x.a)(r,2),c=a[0],i=a[1];return c?Object(M.jsx)($,{children:Object(M.jsx)(X,{value:n,onChange:t,onBlur:function(){return i(!1)}})}):Object(M.jsxs)(ee,{onClick:function(){return i(!0)},children:[Object(M.jsx)("span",{children:Object(M.jsx)(Z.a,{children:n})}),Object(M.jsx)(Q.a,{icon:U.b})]})},te=w.a.div(s||(s=Object(S.a)(["\n  display: flex;\n  border: solid 1px;\n  border-radius: 5px;\n  margin: 1rem;\n\n  .meta {\n    flex-shrink: 0;\n    width: 120px;\n    position: relative;\n    text-align: center;\n    min-height: 50px;\n\n    .speaking {\n      margin-top: 5px;\n    }\n\n    .speaker {\n      width: 120px;\n      height: 80px;\n\n      .speaker-icon {\n        font-size: 30px;\n      }\n\n      .speaker-label {\n        font-weight: bold;\n        cursor: pointer;\n        font-size: 1rem;\n\n        .btn {\n          /* erase the styles brought by react-bootstrap */\n          background-color: unset !important;\n          border: unset !important;\n          color: black;\n        }\n      }\n    }\n  }\n\n  .content {\n    padding: 5px;\n    flex-grow: 1;\n    position: relative;\n\n    .form-control {\n      background-color: transparent !important;\n    }\n\n    .timestamp {\n      position: absolute;\n      font-size: 0.6rem;\n      bottom: 5px;\n      left: 10px;\n    }\n  }\n"]))),re=function(e){var n=e.dialog,t=e.partial,r=e.color,a=void 0===r?"#fff":r,c=e.speakerOptions,i=e.onSetSpeaker,o=e.updateDialog,s=Object(j.useContext)(N),u=s.speakers,l=(s.setSpeakers,Object(j.useState)(!1)),b=Object(x.a)(l,2),d=b[0],f=b[1],p=K()(a),O=n&&(u[n.speaker]||String(n.speaker));return Object(M.jsxs)(te,{style:{borderColor:a},children:[Object(M.jsxs)("div",{className:"meta",style:{backgroundColor:a},children:[n&&Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)("div",{className:"speaker",children:[Object(M.jsx)("div",{className:"speaker-icon",children:Object(M.jsx)(Q.a,{icon:U.c})}),Object(M.jsx)("div",{className:"speaker-label",onClick:function(){return f(!0)},children:Object(M.jsxs)(W.a,{children:[Object(M.jsx)(W.a.Toggle,{children:O}),Object(M.jsx)(W.a.Menu,{show:d,children:c.map((function(e){return Object(M.jsx)(W.a.Item,{href:"#",onClick:function(){return i(n,e)},children:e},e)}))})]})})]})}),t&&Object(M.jsx)("div",{className:"speaking",children:Object(M.jsx)(T.BeatLoader,{})})]}),Object(M.jsxs)("div",{className:"content",style:{backgroundColor:p.lighten(.2).hex()},children:[n&&Object(M.jsx)(ne,{value:n.words,onChange:function(e){o&&n&&o(n.dialogId,e)}}),t&&Object(M.jsx)("span",{children:t}),n&&Object(M.jsxs)("div",{className:"timestamp",children:[Object(M.jsx)(Q.a,{icon:U.a})," ",n.startTime.toFixed(2),"s"]})]})]})},ae=b.a.memo(re),ce=t(237),ie=t.n(ce),oe=t(911),se=t(909),ue=t(416),le=w.a.span(u||(u=Object(S.a)(["\n  cursor: pointer;\n"]))),je=function(e){var n=e.children,t=e.onChange,r=Object(j.useState)(n),a=Object(x.a)(r,2),c=a[0],i=a[1],o=Object(j.useState)(!1),s=Object(x.a)(o,2),u=s[0],l=s[1];return Object(j.useEffect)((function(){i(n)}),[n]),u?Object(M.jsxs)("div",{children:[Object(M.jsx)(se.a.Control,{value:c,onChange:function(e){return i(e.target.value)}}),Object(M.jsx)(ue.a,{onClick:function(){i(n),l(!1)},children:"Cancel"})," ",Object(M.jsx)(ue.a,{onClick:function(){t(c),l(!1)},children:"Save"})]}):Object(M.jsxs)(le,{onClick:function(){return l(!0)},children:[Object(M.jsx)(Q.a,{icon:U.b})," ",c]})},be=w.a.div(l||(l=Object(S.a)(["\n  position: fixed;\n  right: 0;\n  padding: 5px;\n  width: 25%;\n"]))),de=function(e){var n=e.speakerNames,t=e.onNameChange,r=e.unallocatedSpeakerNames,a=e.addNewSpeaker,c=Object(j.useState)(""),i=Object(x.a)(c,2),o=i[0],s=i[1];return Object(M.jsxs)(be,{children:[Object(M.jsx)("h3",{children:"Speakers"}),Object(M.jsxs)(oe.a,{children:[n.map((function(e){return Object(M.jsx)(oe.a.Item,{children:Object(M.jsx)(je,{onChange:function(n){return t(e,n)},children:e})},e)})),r.map((function(e){return Object(M.jsx)(oe.a.Item,{style:{background:"#ccc"},children:Object(M.jsx)(je,{onChange:function(n){return t(e,n)},children:e})},e)}))]}),Object(M.jsx)(se.a.Control,{value:o,onChange:function(e){return s(e.target.value)}}),Object(M.jsx)(ue.a,{disabled:!o,onClick:function(){o&&a(o),s("")},children:"Add Speaker"})]})},fe=[],pe=ie()({count:6,lightMin:80}).map((function(e){return e.hex()})),Oe=function(){var e=Object(j.useState)(void 0),n=Object(x.a)(e,2),t=n[0],r=n[1];Object(j.useEffect)((function(){return Object(g.b)((function(e,n){e===g.a.SignedIn?r(n):r(void 0)}))}),[]);var a=Object(j.useState)(),c=Object(x.a)(a,2),i=c[0],o=c[1],s=Object(j.useState)(),u=Object(x.a)(s,2),l=u[0],b=u[1],d=function(e,n,t){var r=Object(j.useState)([]),a=Object(x.a)(r,2),c=a[0],i=a[1],o=Object(j.useState)(""),s=Object(x.a)(o,2),u=s[0],l=s[1],b=Object(j.useState)(),d=Object(x.a)(b,2),f=d[0],O=(d[1],Object(j.useCallback)((function(e){var n=e.Transcript.Results;if(n.length>0&&n[0].Alternatives.length>0){var t=n[0].Alternatives[0].Transcript;t=decodeURIComponent(escape(t)),n[0].IsPartial?l(t):(l(""),i((function(e){var t,r=[],a=!1,c=Object(p.a)(n[0].Alternatives[0].Items);try{for(c.s();!(t=c.n()).done;){var i=t.value,o=i.Speaker,s=i.Content,u=i.Type,l=i.StartTime,j=i.EndTime;if("speaker-change"!==u){var b=r.length>0?r[r.length-1]:void 0;b&&void 0!==b.speaker&&void 0!==o&&b.speaker!==o&&(a=!0),!b||a?r.push({dialogId:Object(A.a)(),speaker:o,words:s,startTime:l,endTime:j}):(r.pop(),r.push(Object(h.a)(Object(h.a)({},b),{},{words:b.words+("pronunciation"===u?" ":"")+s,endTime:j}))),a=!1}else a=!0}}catch(d){c.e(d)}finally{c.f()}return[].concat(Object(m.a)(e),r)})))}}),[]));return Object(j.useEffect)((function(){e&&n&&!t?(window.handleEventStreamMessage=O,window.region=n,window.access_id=e.AccessKeyId,window.secret_key=e.SecretAccessKey,window.session_token=e.SessionToken,window.startTranscribe()):t&&(window.closeSocket(),console.log("stop button clicked"))}),[e,n,O,t]),{transcription:c,setTranscription:i,partial:u,error:f}}(l,"us-west-2",i),f=d.transcription,S=d.setTranscription,w=d.partial,T=(d.error,Object(j.useState)({})),P=Object(x.a)(T,2),F=P[0],B=P[1],z=Object(j.useState)([]),D=Object(x.a)(z,2),L=D[0],U=D[1],Q=Object(j.useMemo)((function(){return{speakers:F,setSpeakers:B}}),[F]),J=Object(m.a)(new Set(f.map((function(e){var n=e.speaker;return F[n]||String(n)})))).sort();Object(j.useEffect)((function(){U((function(e){return e.filter((function(e){return J.includes(e)})).length>0?e.filter((function(e){return!J.includes(e)})):e}))}),[J]);var K=Object(j.useMemo)((function(){return J.length>6?ie()({count:J.length}).map((function(e){return e.hex()})):pe}),[J.length]),W=Object(j.useCallback)((function(e,n){var t=null;for(var r in F)if(F[r]===e){t=r;break}null===t&&J.includes(e)?t=parseInt(e):console.error("Cannot find speaker with existing name ",e),B(Object(h.a)(Object(h.a)({},F),{},Object(O.a)({},Number(t),n)))}),[F,J]),q=Object(j.useCallback)((function(e){J.includes(e)||L.includes(e)?alert("".concat(e," already exists")):U((function(n){return[].concat(Object(m.a)(n),[e])}))}),[L,J]),G=Object(j.useMemo)((function(){return[].concat(Object(m.a)(J),Object(m.a)(L))}),[J,L]),H=Object(j.useCallback)((function(e,n){var t;if(L.includes(n))t=function(){if(0===fe.length)return fe.push(1e4),1e4;var e=fe[fe.length-1]+1;return fe.push(e),e}();else{var r=null;for(var a in F)if(F[a]===n){r=a;break}null===r&&J.includes(n)?r=parseInt(n):console.error("Cannot find speaker with existing name ",n),t=r}B((function(e){return Object(h.a)(Object(h.a)({},e),{},Object(O.a)({},t,n))})),S((function(n){var r=n.indexOf(e);return[].concat(Object(m.a)(n.slice(0,r)),[Object(h.a)(Object(h.a)({},e),{},{speaker:t})],Object(m.a)(n.slice(r+1)))}))}),[J,S,F,L]),V=Object(j.useCallback)((function(e){var n,t,r=function(e,n){var t,r=["# Transcribe"],a=Object(p.a)(e);try{for(a.s();!(t=a.n()).done;){var c=t.value;r.push("(".concat(c.startTime.toFixed(2),"-").concat(c.endTime.toFixed(2),") **").concat(n[c.speaker]||c.speaker,"** ").concat(c.words))}}catch(i){a.e(i)}finally{a.f()}return r.join("\n\n")}(f,F);(n="/putDocument",t={content:r,documentUrl:e},_.a.currentSession().then((function(e){var r=e.getIdToken().getJwtToken();return E.a.put("SAMAPI",n,{body:t,headers:{Authorization:"Bearer "+r}})}))).then((function(){window.open(e)})).catch((function(e){return alert(e)}))}),[f,F]),X=Object(j.useCallback)((function(e,n){S((function(t){var r,a=[],c=Object(p.a)(t);try{for(c.s();!(r=c.n()).done;){var i=r.value;if(i.dialogId===e){var o=Object(h.a)(Object(h.a)({},i),{},{words:n});a.push(o)}else a.push(i)}}catch(s){c.e(s)}finally{c.f()}return a}))}),[S]);return Object(M.jsx)(v.a,{children:t&&Object(M.jsxs)(I.Provider,{value:t,children:[Object(M.jsx)("div",{children:Object(M.jsx)(k.a,{fluid:!0,style:{marginBottom:"5rem"},children:Object(M.jsxs)(y.a,{children:[Object(M.jsxs)(C.a,{xs:9,children:[Object(M.jsx)("h3",{children:"Conversation"}),Object(M.jsxs)(N.Provider,{value:Q,children:[f.map((function(e,n){return Object(M.jsx)(ae,{dialog:e,color:K[J.indexOf(F[e.speaker]||String(e.speaker))],speakerOptions:G,onSetSpeaker:H,updateDialog:X},n)})),w&&Object(M.jsx)(ae,{partial:w,speakerOptions:G,onSetSpeaker:H})]})]}),Object(M.jsx)(C.a,{children:Object(M.jsx)(de,{speakerNames:J,onNameChange:W,unallocatedSpeakerNames:L,addNewSpeaker:q})})]})})}),Object(M.jsx)(R,{setCredential:b,saveToQuip:V,setStop:o})]})})},he=function(e){e&&e instanceof Function&&t.e(35).then(t.bind(null,925)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,c=n.getLCP,i=n.getTTFB;t(e),r(e),a(e),c(e),i(e)}))};t(232).default.configure({Auth:{identityPoolId:"us-west-2:b712e33e-583d-42df-b9fa-14325852efbf",region:"us-west-2",userPoolId:"us-west-2_gdDt1nKsQ",userPoolWebClientId:"6ihc4536tkdk627cmkomahfmkl"},API:{endpoints:[{name:"SAMAPI",endpoint:"https://3apx34jtve.execute-api.us-west-2.amazonaws.com/Prod"}]}}),f.a.render(Object(M.jsx)(b.a.StrictMode,{children:Object(M.jsx)(Oe,{})}),document.getElementById("root")),he()}},[[846,2,3]]]);
//# sourceMappingURL=main.7aae61b6.chunk.js.map